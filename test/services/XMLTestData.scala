/*
 * Copyright 2018 HM Revenue & Customs
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package services

import java.io.ByteArrayInputStream

import play.api.libs.iteratee.Enumerator
import services.besIntegrationTestData.BESIntegrationTestData
import headers.HeaderData
import scala.collection.mutable.ListBuffer
import scala.concurrent.Future
import scala.xml.Elem

/**
 * Created by raghu on 21/01/16.
 */
object XMLTestData extends BESIntegrationTestData with HeaderData{

  val staxIntegrationTests : ListBuffer[(String,Elem,Elem)] = ListBuffer()

  val besParserTests : ListBuffer[(String,Elem, List[String])] = ListBuffer()

  val besHeaderRows : ListBuffer[(String, Elem)] = ListBuffer()

  val headerData = List(
    emiHeaderSheet1Data,
    otherHeaderSheet1Data,
    csopHeaderSheet1Data,
    sayeHeaderSheet1Data,
    sipHeaderSheet1Data
  )

  val emiXML = <table:table table:name="EMI40_Adjustments_V3" table:style-name="ta1"><table:table-row table:style-name="ro5"><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce11"><text:p>1.</text:p><text:p>Has there been any adjustment of options following a variation in the share capital of the company?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce11"><text:p>2.</text:p><text:p>Has there been a change to the description of the shares under option?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce11"><text:p>3.</text:p><text:p>Is the adjustment a disqualifying event?</text:p><text:p>(yes/no). If YES go to question 4. If NO go to question 5.</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce11"><text:p>4.</text:p><text:p>If yes, enter a number from 1 to 8 depending on the nature of the disqualifying event.</text:p><text:p>Follow the link at cell A7 for a list of disqualifying events</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>5.</text:p><text:p>Date option adjusted</text:p><text:p>(yyyy-mm-dd)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>6.</text:p><text:p>Employee first name</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>7.</text:p><text:p>Employee second name</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>8.</text:p><text:p>Employee last name</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>9.</text:p><text:p>National Insurance number</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>10.</text:p><text:p>PAYE reference of employing company</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>11.</text:p><text:p>Exercise price per share under option before adjustment</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce13"><text:p>12.</text:p><text:p>Number of shares under the option after adjustment</text:p><text:p>e.g. 100.00</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>13.</text:p><text:p>Exercise price per share under option after the adjustment £</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>14.</text:p><text:p>Actual market value of a share at the date of grant</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell table:number-columns-repeated="16370" table:style-name="ce3"/></table:table-row></table:table>
  val emiXMLRow1 = <table:table-row table:style-name="ro5"><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce11"><text:p>1.</text:p><text:p>Has there been any adjustment of options following a variation in the share capital of the company?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce11"><text:p>2.</text:p><text:p>Has there been a change to the description of the shares under option?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce11"><text:p>3.</text:p><text:p>Is the adjustment a disqualifying event?</text:p><text:p>(yes/no). If YES go to question 4. If NO go to question 5.</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce11"><text:p>4.</text:p><text:p>If yes, enter a number from 1 to 8 depending on the nature of the disqualifying event.</text:p><text:p>Follow the link at cell A7 for a list of disqualifying events</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>5.</text:p><text:p>Date option adjusted</text:p><text:p>(yyyy-mm-dd)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>6.</text:p><text:p>Employee first name</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>7.</text:p><text:p>Employee second name</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>8.</text:p><text:p>Employee last name</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>9.</text:p><text:p>National Insurance number</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>10.</text:p><text:p>PAYE reference of employing company</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>11.</text:p><text:p>Exercise price per share under option before adjustment</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce13"><text:p>12.</text:p><text:p>Number of shares under the option after adjustment</text:p><text:p>e.g. 100.00</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>13.</text:p><text:p>Exercise price per share under option after the adjustment £</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>14.</text:p><text:p>Actual market value of a share at the date of grant</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell table:number-columns-repeated="16370" table:style-name="ce3"/></table:table-row>

  val csopXML = <table:table table:name="EMI40_Adjustments_V3" table:style-name="ta1"><table:table-row table:style-name="ro6"><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>1.</text:p><text:p>Date of event</text:p><text:p>(yyyy-mm-dd)</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>2.</text:p><text:p>Number of employees who acquired or were awarded shares</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>3.</text:p><text:p>Type of shares awarded</text:p><text:p>Enter a number from 1 to 4 depending on the type of share awarded. Follow the link at cell B10 for a list of the types of share which can be awarded</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>4.</text:p><text:p>If free shares, are performance conditions attached to their award?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>5.</text:p><text:p>If matching shares, what is the ratio of shares to partnership shares?</text:p><text:p>Enter ratio for example 2:1; 2/1</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>6.</text:p><text:p>Unrestricted market value (UMV) per share on acquisition or award</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>7.</text:p><text:p>Total number of shares acquired or awarded</text:p><text:p>e.g. 100.00</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>8.</text:p><text:p>Total value of shares acquired or awarded</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>9.</text:p><text:p>Total number of employees whose award of free shares during the year exceeded the limit of £3,600</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>10.</text:p><text:p>Total number of employees whose award of free shares during the year was at or below the limit of £3,600</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>11.</text:p><text:p>Total number of employees whose award of partnership shares during the year exceeded the limit of £1,800</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>12.</text:p><text:p>Total number of employees whose award of partnership shares during the year was at or below the limit of £1,800</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>13.</text:p><text:p>Total number of employees whose award of matching shares during the year exceeded the limit of £3,600</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>14.</text:p><text:p>Total number of employees whose award of matching shares during the year was at or below the limit of £3,600</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>15.</text:p><text:p>Are the shares listed on a recognised stock exchange?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>16.</text:p><text:p>If no, was the market value agreed with HMRC?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>17.</text:p><text:p>If yes, enter the HMRC reference given</text:p></table:table-cell><table:table-cell table:style-name="ce11"/><table:table-cell table:number-columns-repeated="1003"/><table:table-cell table:style-name="ce17"/><table:table-cell table:number-columns-repeated="2"/></table:table-row></table:table>
  val csopXMLRow1 = <table:table-row table:style-name="ro6"><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>1.</text:p><text:p>Date of event</text:p><text:p>(yyyy-mm-dd)</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>2.</text:p><text:p>Number of employees who acquired or were awarded shares</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>3.</text:p><text:p>Type of shares awarded</text:p><text:p>Enter a number from 1 to 4 depending on the type of share awarded. Follow the link at cell B10 for a list of the types of share which can be awarded</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>4.</text:p><text:p>If free shares, are performance conditions attached to their award?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>5.</text:p><text:p>If matching shares, what is the ratio of shares to partnership shares?</text:p><text:p>Enter ratio for example 2:1; 2/1</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>6.</text:p><text:p>Unrestricted market value (UMV) per share on acquisition or award</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>7.</text:p><text:p>Total number of shares acquired or awarded</text:p><text:p>e.g. 100.00</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>8.</text:p><text:p>Total value of shares acquired or awarded</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>9.</text:p><text:p>Total number of employees whose award of free shares during the year exceeded the limit of £3,600</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>10.</text:p><text:p>Total number of employees whose award of free shares during the year was at or below the limit of £3,600</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>11.</text:p><text:p>Total number of employees whose award of partnership shares during the year exceeded the limit of £1,800</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>12.</text:p><text:p>Total number of employees whose award of partnership shares during the year was at or below the limit of £1,800</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>13.</text:p><text:p>Total number of employees whose award of matching shares during the year exceeded the limit of £3,600</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>14.</text:p><text:p>Total number of employees whose award of matching shares during the year was at or below the limit of £3,600</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>15.</text:p><text:p>Are the shares listed on a recognised stock exchange?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>16.</text:p><text:p>If no, was the market value agreed with HMRC?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell table:style-name="ce6" office:value-type="string" calcext:value-type="string"><text:p>17.</text:p><text:p>If yes, enter the HMRC reference given</text:p></table:table-cell><table:table-cell table:style-name="ce11"/><table:table-cell table:number-columns-repeated="1003"/><table:table-cell table:style-name="ce17"/><table:table-cell table:number-columns-repeated="2"/></table:table-row>
  val csopRowExpData = List("2014-12-10",	"yes",	"column3",	"emp first name")


  besParserTests +=(("Stream CSOP Options Granted Header", csopXMLHeaderSheet1, csopHeaderSheet1Data))
  besParserTests +=(("Stream CSOP Options RCL Header", csopXMLHeaderSheet2,csopHeaderSheet2Data))
  besParserTests +=(("Stream CSOP Options Exercised Header", csopXMLHeaderSheet3,csopHeaderSheet3Data))
  besParserTests +=(("Stream EMI Adjustments Header", emiXMLHeaderSheet1, emiHeaderSheet1Data))
  besParserTests +=(("Stream EMI Replaced Header", emiXMLHeaderSheet2, emiHeaderSheet2Data))
  besParserTests +=(("Stream EMI RLC Header", emiXMLHeaderSheet3, emiHeaderSheet3Data))
  besParserTests +=(("Stream EMI NonTaxable Header", emiXMLHeaderSheet4, emiHeaderSheet4Data))
  besParserTests +=(("Stream EMI Taxable Header", emiXMLHeaderSheet5, emiHeaderSheet5Data))
  besParserTests +=(("Stream Other Grants Header", otherXMLHeaderSheet1, otherHeaderSheet1Data))
  besParserTests +=(("Stream Other Options Header", otherXMLHeaderSheet2, otherHeaderSheet2Data))
  besParserTests +=(("Stream Other Acquisition Header", otherXMLHeaderSheet3, otherHeaderSheet3Data))
  besParserTests +=(("Stream Other RestrictedSecurities Header", otherXMLHeaderSheet4, otherHeaderSheet4Data))
  besParserTests +=(("Stream Other OtherBenefits Header", otherXMLHeaderSheet5, otherHeaderSheet5Data))
  besParserTests +=(("Stream Other Convertible Header", otherXMLHeaderSheet6, otherHeaderSheet6Data))
  besParserTests +=(("Stream Other Notional Header", otherXMLHeaderSheet7, otherHeaderSheet7Data))
  besParserTests +=(("Stream Other Enhancement Header", otherXMLHeaderSheet8, otherHeaderSheet8Data))
  besParserTests +=(("Stream Other Sold Header", otherXMLHeaderSheet9, otherHeaderSheet9Data))
  besParserTests +=(("Stream SAYE Granted Header", sayeXMLHeaderSheet1, sayeHeaderSheet1Data))
  besParserTests +=(("Stream SAYE RCL Header", sayeXMLHeaderSheet2, sayeHeaderSheet2Data))
  besParserTests +=(("Stream SAYE Exercised Header", sayeXMLHeaderSheet3, sayeHeaderSheet3Data))
  besParserTests +=(("Stream SIP Awards Header", sipXMLHeaderSheet1, sipHeaderSheet1Data))
  besParserTests +=(("Stream SIP Out Header", sipXMLHeaderSheet2, sipHeaderSheet2Data))



  staxIntegrationTests += (("stream EMI xml Row " , emiXML, emiXMLRow1))
  staxIntegrationTests += (("stream CSOP xml Row ",csopXML,  csopXMLRow1))
  staxIntegrationTests += (("stream SIP Awards xml Row", sipAwardsXML, sipAwardsXMLRow1))
  staxIntegrationTests += (("stream SIP Out xml Row", sipOutXML, sipOutXMLRow1))
  staxIntegrationTests += (("stream SAYE Granted xml Row", sayeGrantedXML, sayeGrantedXMLRow1))
  staxIntegrationTests += (("stream SAYE RCL xml Row", sayeRCLXML, sayeRCLXMLRow1))
  staxIntegrationTests += (("stream SAYE Exercised xml Row", sayeExercisedXML, sayeExercisedXMLRow1))
  staxIntegrationTests += (("stream EMI Adjustments xml Row", emiAdjustmentsXML, emiAdjustmentsXMLRow1))
  staxIntegrationTests += (("stream EMI Replaced xml Row", emiReplacedXML,emiReplacedXMLRow1))
  staxIntegrationTests += (("stream EMI RLC xml Row", emiRLCXML,emiRLCXMLRow1))
  staxIntegrationTests += (("stream EMI Non-Taxable xml Row", emiNonTaxableXML,emiNonTaxableXMLRow1))
  staxIntegrationTests += (("stream EMI Taxable xml Row", emiTaxableXML,emiTaxableXMLRow1))
  staxIntegrationTests += (("Stream Other Grants xml Row", otherGrantsXML, otherGrantsXMLRow1))
  staxIntegrationTests += (("Stream Other Option xml Row", otherOptionsXML, otherOptionsXMLRow1))
  staxIntegrationTests += (("Stream Other Acquisition xml Row", otherAcquisitionsXML, otherAcquisitionsXMLRow1))
  staxIntegrationTests += (("Stream Other Restricted Securities xml Row", otherRestrictedSecuritiesXML, otherRestrictedSecuritiesXMLRow1))
  staxIntegrationTests += (("Stream Other Benefits xml Row", otherBenefitsXML, otherBenefitsXMLRow1))
  staxIntegrationTests += (("Stream Other Convertibles xml Row", otherConvertibleXML, otherConvertibleXMLRow1))
  staxIntegrationTests += (("Stream Other Notional xml Row", otherNotionalXML, otherNotionalXMLRow1))
  staxIntegrationTests += (("Stream Other Enhancement xml Row", otherEnhancementXML, otherEnhancementXMLRow1 ))
  staxIntegrationTests += (("Stream Other Sold xml Row", otherSoldXML, otherSoldXMLRow1))
  staxIntegrationTests += (("Stream CSOP Options Granted xml Row", csopOptionsGrantedXML, csopOptionsGrantedXMLRow1))
  staxIntegrationTests += (("Stream CSOP Options RCL xml Row", csopOptionsRCLXML, csopOptionsRCLXMLRow1))
  staxIntegrationTests += (("Stream CSOP Options Exercised xml Row", csopOptionsExercisedXML, csopOptionsExercisedXMLRow1))

  def getMockTestData(testData:Elem) = Future.successful(Enumerator(testData.toString.getBytes()))

  // besParserTests += (("parse row with duplicate column data", emiAdjustmentsXMLRow1, emiAdjustmentsExpData))
  // besParserTests += (("parse EMI xml Row and retrieve row data " ,  emiXMLRow1 , emiRowExpData))
  besParserTests += (("parse EMI Adjustments xml Row and retrieve row data", emiAdjustmentsXMLRow1, emiAdjustmentsExpData))
  besParserTests += (("parse EMI NonTaxable xml Row and retrieve row data",emiNonTaxableXMLRow1 , emiNonTaxableExpData))
  //besParserTests += (("parse EMI Replaced xml Row and retrieve row data",emiReplacedXMLRow1 , emiReplacedExpData))
  besParserTests += (("parse EMI RCL xml Row and retrieve row data",emiRLCXMLRow1 , emiRLCExpData))
  besParserTests += (("parse EMI Taxable xml Row and retrieve row data",emiTaxableXMLRow1 , emiTaxableExpData))
  besParserTests += (("parse SIP Awards xml Row and retrieve row data",sipAwardsXMLRow1 , sipAwardsExpData))
  besParserTests += (("parse SIP Out xml Row and retrieve row data",sipOutXMLRow1 , sipOutExpData))
  besParserTests += (("parse Other Acquisitions xml Row and retrieve row data", otherAcquisitionsXMLRow1, otherAcquisitionsData))
  besParserTests += (("parse Other Benefits xml Row and retrieve row data", otherBenefitsXMLRow1, otherBenefitsData))
  besParserTests += (("parse Other Convertible xml Row and retrieve row data", otherConvertibleXMLRow1, otherConvertibleBenefitsData))
  besParserTests += (("parse Other Enhancements xml Row and retrieve row data", otherEnhancementXMLRow1, otherEnhancementData))
  besParserTests += (("parse Other Grants xml Row and retrieve row data", otherGrantsXMLRow1, otherGrantsExpData))
  besParserTests += (("parse Other Notional xml Row and retrieve row data", otherNotionalXMLRow1, otherNotionalData))
  besParserTests += (("parse Other Options xml Row and retrieve row data", otherOptionsXMLRow1, otherOptionsData))
  besParserTests += (("parse Other Restricted xml Row and retrieve row data", otherRestrictedSecuritiesXMLRow1, otherRestrictedSecuritiesData))
  besParserTests += (("parse Other Sold xml Row and retrieve row data", otherSoldXMLRow1, otherSoldData))
  besParserTests += (("parse SAYE Exercised xml Row and retrieve row data", sayeExercisedXMLRow1, sayeExercisedExpData))
  besParserTests += (("parse SAYE Granted xml Row and retrieve row data", sayeGrantedXMLRow1, sayeGrantedExpData))
  besParserTests += (("parse SAYE RCL xml Row and retrieve row data", sayeRCLXMLRow1, sayeRCLExpData))
  besParserTests += (("parse CSOP Exercised xml Row and retrieve row data", csopOptionsExercisedXMLRow1, csopOptionsExercisedExpData))
  besParserTests += (("parse CSOP Granted xml Row and retrieve row data", csopOptionsGrantedXMLRow1, csopOptionsGrantedExpData))
  besParserTests += (("parse CSOP RCL xml Row and retrieve row data", csopOptionsRCLXMLRow1, csopOptionsRCLExpData))

 def getEMIAdjustmentsTemplate =
  {
   val sheetName = "EMI40_Adjustments_V3"
    val row1 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce26"><text:p>EMI template - Adjustment of options</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row2 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce27"><text:p>How to complete this schedule:</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row3 = <table:table-row table:style-name="ro2"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce28"><text:p><text:span text:style-name="T1">ONLY complete this sheet if, following a variation in the share capital of the company whose shares are under option, there has been an adjustment of the option price or there has been a change in the description of shares under option.<text:s/></text:span><text:span text:style-name="T1"/></text:p><text:p><text:span text:style-name="T4">Please note</text:span>: Monetary values must be entered to 4 decimal places in pounds sterling.</text:p><text:p>Numbers of shares and securities must be entered to 2 decimal places in pounds sterling.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row4 = <table:table-row table:style-name="ro3"><table:table-cell office:value-type="string" table:number-columns-spanned="6" table:number-rows-spanned="1" table:style-name="ce28"><text:p>Please note: Monetary values must be entered to 4 decimal places in pounds sterling.</text:p><text:p>Numbers of shares and securities must be entered to 2 decimal places.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="5"/><table:table-cell table:number-columns-repeated="8" table:style-name="ce3"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row5 = <table:table-row table:style-name="ro4"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce28"><text:p><text:span text:style-name="T2">Important note</text:span><text:span text:style-name="T2"/></text:p><text:p>You<text:s/><text:span text:style-name="T4">must not</text:span><text:s/>alter the structure or formatting of this schedule. If you do your schedule will be rejected.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row6 = <table:table-row table:style-name="ro2"><table:table-cell office:value-type="string" table:number-columns-spanned="12" table:number-rows-spanned="1" table:style-name="ce28"><text:p>For more information on completing this schedule, follow the link below. You must be connected to the internet to access the guide.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="11"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce4"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
  val row7 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:style-name="ce5"><text:p><text:a xlink:href="https://www.gov.uk/government/publications/enterprise-management-incentives-end-of-year-template">EMI guidance</text:a></text:p></table:table-cell><table:table-cell table:style-name="ce6"/><table:table-cell table:number-columns-spanned="3" table:number-rows-spanned="1" table:style-name="ce29"/><table:covered-table-cell table:number-columns-repeated="2"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce7"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:style-name="ce9"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce4"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
  val row8 = <table:table-row table:style-name="ro1"><table:table-cell table:number-columns-repeated="4" table:style-name="ce10"/><table:table-cell table:number-columns-repeated="16380" table:style-name="ce2"/></table:table-row>.toString
  val row9EMIAdjustmentsHeader = <table:table-row table:style-name="ro5"><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce11"><text:p>1.</text:p><text:p>Has there been any adjustment of options following a variation in the share capital of the company?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce11"><text:p>2.</text:p><text:p>Has there been a change to the description of the shares under option?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce11"><text:p>3.</text:p><text:p>Is the adjustment a disqualifying event?</text:p><text:p>(yes/no). If YES go to question 4. If NO go to question 5.</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce11"><text:p>4.</text:p><text:p>If yes, enter a number from 1 to 8 depending on the nature of the disqualifying event.</text:p><text:p>Follow the link at cell A7 for a list of disqualifying events</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>5.</text:p><text:p>Date option adjusted</text:p><text:p>(yyyy-mm-dd)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>6.</text:p><text:p>Employee first name</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>7.</text:p><text:p>Employee second name</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>8.</text:p><text:p>Employee last name</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>9.</text:p><text:p>National Insurance number</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>10.</text:p><text:p>PAYE reference of employing company</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>11.</text:p><text:p>Exercise price per share under option before adjustment</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce13"><text:p>12.</text:p><text:p>Number of shares under the option after adjustment</text:p><text:p>e.g. 100.00</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>13.</text:p><text:p>Exercise price per share under option after the adjustment £</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>14.</text:p><text:p>Actual market value of a share at the date of grant</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell table:number-columns-repeated="16370" table:style-name="ce3"/></table:table-row>.toString

    Iterator(sheetName,row1,row2,row3,row4,row5,row6,row7,row8,row9EMIAdjustmentsHeader,emiAdjustmentsXMLRow1.toString)
  }

  def getEMIAdjustmentsRepeatedTemplate =
  {
    val sheetName = "EMI40_Adjustments_V3"
    val row1 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce26"><text:p>EMI template - Adjustment of options</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row2 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce27"><text:p>How to complete this schedule:</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row3 = <table:table-row table:style-name="ro2"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce28"><text:p><text:span text:style-name="T1">ONLY complete this sheet if, following a variation in the share capital of the company whose shares are under option, there has been an adjustment of the option price or there has been a change in the description of shares under option.<text:s/></text:span><text:span text:style-name="T1"/></text:p><text:p><text:span text:style-name="T4">Please note</text:span>: Monetary values must be entered to 4 decimal places in pounds sterling.</text:p><text:p>Numbers of shares and securities must be entered to 2 decimal places in pounds sterling.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row4 = <table:table-row table:style-name="ro3"><table:table-cell office:value-type="string" table:number-columns-spanned="6" table:number-rows-spanned="1" table:style-name="ce28"><text:p>Please note: Monetary values must be entered to 4 decimal places in pounds sterling.</text:p><text:p>Numbers of shares and securities must be entered to 2 decimal places.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="5"/><table:table-cell table:number-columns-repeated="8" table:style-name="ce3"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row5 = <table:table-row table:style-name="ro4"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce28"><text:p><text:span text:style-name="T2">Important note</text:span><text:span text:style-name="T2"/></text:p><text:p>You<text:s/><text:span text:style-name="T4">must not</text:span><text:s/>alter the structure or formatting of this schedule. If you do your schedule will be rejected.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row6 = <table:table-row table:style-name="ro2"><table:table-cell office:value-type="string" table:number-columns-spanned="12" table:number-rows-spanned="1" table:style-name="ce28"><text:p>For more information on completing this schedule, follow the link below. You must be connected to the internet to access the guide.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="11"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce4"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row7 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:style-name="ce5"><text:p><text:a xlink:href="https://www.gov.uk/government/publications/enterprise-management-incentives-end-of-year-template">EMI guidance</text:a></text:p></table:table-cell><table:table-cell table:style-name="ce6"/><table:table-cell table:number-columns-spanned="3" table:number-rows-spanned="1" table:style-name="ce29"/><table:covered-table-cell table:number-columns-repeated="2"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce7"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:style-name="ce9"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce4"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row8 = <table:table-row table:style-name="ro1"><table:table-cell table:number-columns-repeated="4" table:style-name="ce10"/><table:table-cell table:number-columns-repeated="16380" table:style-name="ce2"/></table:table-row>.toString
    val row9EMIAdjustmentsHeader = <table:table-row table:style-name="ro5"><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce11"><text:p>1.</text:p><text:p>Has there been any adjustment of options following a variation in the share capital of the company?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce11"><text:p>2.</text:p><text:p>Has there been a change to the description of the shares under option?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce11"><text:p>3.</text:p><text:p>Is the adjustment a disqualifying event?</text:p><text:p>(yes/no). If YES go to question 4. If NO go to question 5.</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce11"><text:p>4.</text:p><text:p>If yes, enter a number from 1 to 8 depending on the nature of the disqualifying event.</text:p><text:p>Follow the link at cell A7 for a list of disqualifying events</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>5.</text:p><text:p>Date option adjusted</text:p><text:p>(yyyy-mm-dd)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>6.</text:p><text:p>Employee first name</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>7.</text:p><text:p>Employee second name</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>8.</text:p><text:p>Employee last name</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>9.</text:p><text:p>National Insurance number</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>10.</text:p><text:p>PAYE reference of employing company</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>11.</text:p><text:p>Exercise price per share under option before adjustment</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce13"><text:p>12.</text:p><text:p>Number of shares under the option after adjustment</text:p><text:p>e.g. 100.00</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>13.</text:p><text:p>Exercise price per share under option after the adjustment £</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>14.</text:p><text:p>Actual market value of a share at the date of grant</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell table:number-columns-repeated="16370" table:style-name="ce3"/></table:table-row>.toString

    Iterator(sheetName,row1,row2,row3,row4,row5,row6,row7,row8,row9EMIAdjustmentsHeader,emiAdjustmentsXMLRow1.toString, emiAdjustmentsRepeatXMLRow1.toString())
  }

  def openTable(sheetName: String) = s"""<table:table table:name="${sheetName}" table:style-name="ta1">"""
  val closeTable = """</table:table>"""

  def getEMIAdjustmentsTemplateSTAX = {
    val sheetName = "EMI40_Adjustments_V3"
    val row1 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce26"><text:p>EMI template - Adjustment of options</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row2 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce27"><text:p>How to complete this schedule:</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row3 = <table:table-row table:style-name="ro2"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce28"><text:p><text:span text:style-name="T1">ONLY complete this sheet if, following a variation in the share capital of the company whose shares are under option, there has been an adjustment of the option price or there has been a change in the description of shares under option.<text:s/></text:span><text:span text:style-name="T1"/></text:p><text:p><text:span text:style-name="T4">Please note</text:span>: Monetary values must be entered to 4 decimal places in pounds sterling.</text:p><text:p>Numbers of shares and securities must be entered to 2 decimal places in pounds sterling.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row4 = <table:table-row table:style-name="ro3"><table:table-cell office:value-type="string" table:number-columns-spanned="6" table:number-rows-spanned="1" table:style-name="ce28"><text:p>Please note: Monetary values must be entered to 4 decimal places in pounds sterling.</text:p><text:p>Numbers of shares and securities must be entered to 2 decimal places.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="5"/><table:table-cell table:number-columns-repeated="8" table:style-name="ce3"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row5 = <table:table-row table:style-name="ro4"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce28"><text:p><text:span text:style-name="T2">Important note</text:span><text:span text:style-name="T2"/></text:p><text:p>You<text:s/><text:span text:style-name="T4">must not</text:span><text:s/>alter the structure or formatting of this schedule. If you do your schedule will be rejected.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row6 = <table:table-row table:style-name="ro2"><table:table-cell office:value-type="string" table:number-columns-spanned="12" table:number-rows-spanned="1" table:style-name="ce28"><text:p>For more information on completing this schedule, follow the link below. You must be connected to the internet to access the guide.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="11"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce4"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row7 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:style-name="ce5"><text:p><text:a xlink:href="https://www.gov.uk/government/publications/enterprise-management-incentives-end-of-year-template">EMI guidance</text:a></text:p></table:table-cell><table:table-cell table:style-name="ce6"/><table:table-cell table:number-columns-spanned="3" table:number-rows-spanned="1" table:style-name="ce29"/><table:covered-table-cell table:number-columns-repeated="2"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce7"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:style-name="ce9"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce4"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row8 = <table:table-row table:style-name="ro1"><table:table-cell table:number-columns-repeated="4" table:style-name="ce10"/><table:table-cell table:number-columns-repeated="16380" table:style-name="ce2"/></table:table-row>.toString
    val row9EMIAdjustmentsHeader = <table:table-row table:style-name="ro5"><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce11"><text:p>1.</text:p><text:p>Has there been any adjustment of options following a variation in the share capital of the company?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce11"><text:p>2.</text:p><text:p>Has there been a change to the description of the shares under option?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce11"><text:p>3.</text:p><text:p>Is the adjustment a disqualifying event?</text:p><text:p>(yes/no). If YES go to question 4. If NO go to question 5.</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce11"><text:p>4.</text:p><text:p>If yes, enter a number from 1 to 8 depending on the nature of the disqualifying event.</text:p><text:p>Follow the link at cell A7 for a list of disqualifying events</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>5.</text:p><text:p>Date option adjusted</text:p><text:p>(yyyy-mm-dd)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>6.</text:p><text:p>Employee first name</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>7.</text:p><text:p>Employee second name</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>8.</text:p><text:p>Employee last name</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>9.</text:p><text:p>National Insurance number</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>10.</text:p><text:p>PAYE reference of employing company</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>11.</text:p><text:p>Exercise price per share under option before adjustment</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce13"><text:p>12.</text:p><text:p>Number of shares under the option after adjustment</text:p><text:p>e.g. 100.00</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>13.</text:p><text:p>Exercise price per share under option after the adjustment £</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>14.</text:p><text:p>Actual market value of a share at the date of grant</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell table:number-columns-repeated="16370" table:style-name="ce3"/></table:table-row>.toString

    val inputXml = openTable(sheetName) + row1 + row2 + row3 + row4 + row5 + row6 + row7 + row8 + row9EMIAdjustmentsHeader + emiAdjustmentsXMLRow1.toString() + closeTable
    new StaxProcessor(new ByteArrayInputStream(inputXml.getBytes("utf-8")))
  }

  def getEMIAdjustmentsTemplateLarge = {
    val sheetName = "EMI40_Adjustments_V3"
    val row1 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce26"><text:p>EMI template - Adjustment of options</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row2 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce27"><text:p>How to complete this schedule:</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row3 = <table:table-row table:style-name="ro2"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce28"><text:p><text:span text:style-name="T1">ONLY complete this sheet if, following a variation in the share capital of the company whose shares are under option, there has been an adjustment of the option price or there has been a change in the description of shares under option.<text:s/></text:span><text:span text:style-name="T1"/></text:p><text:p><text:span text:style-name="T4">Please note</text:span>: Monetary values must be entered to 4 decimal places in pounds sterling.</text:p><text:p>Numbers of shares and securities must be entered to 2 decimal places in pounds sterling.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row4 = <table:table-row table:style-name="ro3"><table:table-cell office:value-type="string" table:number-columns-spanned="6" table:number-rows-spanned="1" table:style-name="ce28"><text:p>Please note: Monetary values must be entered to 4 decimal places in pounds sterling.</text:p><text:p>Numbers of shares and securities must be entered to 2 decimal places.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="5"/><table:table-cell table:number-columns-repeated="8" table:style-name="ce3"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row5 = <table:table-row table:style-name="ro4"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce28"><text:p><text:span text:style-name="T2">Important note</text:span><text:span text:style-name="T2"/></text:p><text:p>You<text:s/><text:span text:style-name="T4">must not</text:span><text:s/>alter the structure or formatting of this schedule. If you do your schedule will be rejected.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row6 = <table:table-row table:style-name="ro2"><table:table-cell office:value-type="string" table:number-columns-spanned="12" table:number-rows-spanned="1" table:style-name="ce28"><text:p>For more information on completing this schedule, follow the link below. You must be connected to the internet to access the guide.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="11"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce4"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row7 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:style-name="ce5"><text:p><text:a xlink:href="https://www.gov.uk/government/publications/enterprise-management-incentives-end-of-year-template">EMI guidance</text:a></text:p></table:table-cell><table:table-cell table:style-name="ce6"/><table:table-cell table:number-columns-spanned="3" table:number-rows-spanned="1" table:style-name="ce29"/><table:covered-table-cell table:number-columns-repeated="2"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce7"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:style-name="ce9"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce4"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row8 = <table:table-row table:style-name="ro1"><table:table-cell table:number-columns-repeated="4" table:style-name="ce10"/><table:table-cell table:number-columns-repeated="16380" table:style-name="ce2"/></table:table-row>.toString
    val row9EMIAdjustmentsHeader = <table:table-row table:style-name="ro5"><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce11"><text:p>1.</text:p><text:p>Has there been any adjustment of options following a variation in the share capital of the company?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce11"><text:p>2.</text:p><text:p>Has there been a change to the description of the shares under option?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce11"><text:p>3.</text:p><text:p>Is the adjustment a disqualifying event?</text:p><text:p>(yes/no). If YES go to question 4. If NO go to question 5.</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce11"><text:p>4.</text:p><text:p>If yes, enter a number from 1 to 8 depending on the nature of the disqualifying event.</text:p><text:p>Follow the link at cell A7 for a list of disqualifying events</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>5.</text:p><text:p>Date option adjusted</text:p><text:p>(yyyy-mm-dd)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>6.</text:p><text:p>Employee first name</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>7.</text:p><text:p>Employee second name</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>8.</text:p><text:p>Employee last name</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>9.</text:p><text:p>National Insurance number</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>10.</text:p><text:p>PAYE reference of employing company</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>11.</text:p><text:p>Exercise price per share under option before adjustment</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce13"><text:p>12.</text:p><text:p>Number of shares under the option after adjustment</text:p><text:p>e.g. 100.00</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>13.</text:p><text:p>Exercise price per share under option after the adjustment £</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>14.</text:p><text:p>Actual market value of a share at the date of grant</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell table:number-columns-repeated="16370" table:style-name="ce3"/></table:table-row>.toString

    val inputXml = openTable(sheetName) + row1 + row2 + row3 + row4 + row5 + row6 + row7 + row8 + row9EMIAdjustmentsHeader + emiAdjustmentsXMLRow1.toString() + emiAdjustmentsXMLRow1.toString() + emiAdjustmentsXMLRow1.toString() + closeTable
    new StaxProcessor(new ByteArrayInputStream(inputXml.getBytes("utf-8")))
  }


  def getEMIReplacedTemplate =
  {
    val sheetName = "EMI40_Replaced_V3"
    val row1 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce1" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="17" table:number-rows-spanned="1"><text:p>EMI template – Replacement of options</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="16"/><table:table-cell table:number-columns-repeated="1007"/></table:table-row>.toString
    val row2 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce2" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="17" table:number-rows-spanned="1"><text:p>How to complete this schedule:</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="16"/><table:table-cell table:number-columns-repeated="1007"/></table:table-row>.toString
    val row3 = <table:table-row table:style-name="ro2"><table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="17" table:number-rows-spanned="1"><text:p>Enter details of options replaced in relation to a company reorganisation.</text:p><text:p><text:span text:style-name="T1">Please note</text:span>: Monetary values must be entered to 4 decimal places in pounds sterling.</text:p><text:p/></table:table-cell><table:covered-table-cell table:number-columns-repeated="16"/><table:table-cell table:number-columns-repeated="1007"/></table:table-row>.toString
    val row4 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce2" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="17" table:number-rows-spanned="1"><text:p>Important note</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="16"/><table:table-cell table:number-columns-repeated="1007"/></table:table-row>.toString
    val row5 = <table:table-row table:style-name="ro3"><table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1"><text:p>You <text:span text:style-name="T2">must not</text:span> alter the structure or formatting of this schedule. If you do your schedule will be rejected.</text:p><text:p>Please note when completing the template if you leave 10 or more consecutive rows blank with no data populated, It will be assumed that there is no further information contained below these blank rows within this sheet. </text:p><text:p>Therefore it is important you do not leave blank rows between the rows of data you are reporting. Note the system will continue to check for information on subsequent sheets within the same template.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:style-name="ce13" table:number-columns-repeated="2"/><table:table-cell table:style-name="ce7"/><table:table-cell table:number-columns-repeated="1007"/></table:table-row>.toString
    val row6 = <table:table-row table:style-name="ro4"><table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="12" table:number-rows-spanned="1"><text:p>For more information on completing this schedule, follow the link below. You must be connected to the internet to access the guide.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="11"/><table:table-cell table:style-name="ce13" table:number-columns-repeated="4"/><table:table-cell table:style-name="ce7"/><table:table-cell table:number-columns-repeated="1007"/></table:table-row>.toString
    val row7 = <table:table-row table:style-name="ro5"><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p><text:a xlink:href="https://www.gov.uk/government/publications/enterprise-management-incentives-end-of-year-template" xlink:type="simple">EMI guidance</text:a></text:p></table:table-cell><table:table-cell table:style-name="ce7" table:number-columns-repeated="5"/><table:table-cell table:style-name="ce9" table:number-columns-repeated="2"/><table:table-cell table:style-name="ce12" table:content-validation-name="val2" table:number-columns-repeated="8"/><table:table-cell table:style-name="ce9"/><table:table-cell table:number-columns-repeated="1007"/></table:table-row>.toString
    val row8 = <table:table-row table:style-name="ro1"><table:table-cell table:number-columns-repeated="7"/><table:table-cell table:content-validation-name="val2" table:number-columns-repeated="8"/><table:table-cell table:number-columns-repeated="1009"/></table:table-row>.toString
    val row9ReplacedHeader = <table:table-row table:style-name="ro6"><table:table-cell table:style-name="ce3" table:content-validation-name="val1" office:value-type="string" calcext:value-type="string"><text:p>1.</text:p><text:p>Date of grant of old option</text:p><text:p>(yyyy-mm-dd)</text:p></table:table-cell><table:table-cell table:style-name="ce8" table:content-validation-name="val1" office:value-type="string" calcext:value-type="string"><text:p>2.</text:p><text:p>Date of grant of new option</text:p><text:p>(yyyy-mm-dd)</text:p></table:table-cell><table:table-cell table:style-name="ce3" table:content-validation-name="val1" office:value-type="string" calcext:value-type="string"><text:p>3.</text:p><text:p>Employee first name</text:p></table:table-cell><table:table-cell table:style-name="ce3" table:content-validation-name="val1" office:value-type="string" calcext:value-type="string"><text:p>4.</text:p><text:p>Employee second name</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell table:style-name="ce3" table:content-validation-name="val1" office:value-type="string" calcext:value-type="string"><text:p>5.</text:p><text:p>Employee last name</text:p></table:table-cell><table:table-cell table:style-name="ce3" table:content-validation-name="val1" office:value-type="string" calcext:value-type="string"><text:p>6.</text:p><text:p>National Insurance number</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string"><text:p>7.</text:p><text:p>PAYE reference of employing company</text:p></table:table-cell><table:table-cell table:style-name="ce11" table:content-validation-name="val1" office:value-type="string" calcext:value-type="string"><text:p>8.</text:p><text:p>Actual market value of original shares at the date the option(s) were replaced</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell table:style-name="ce3" table:content-validation-name="val1" office:value-type="string" calcext:value-type="string"><text:p>9.</text:p><text:p>Name of the company whose shares are the subject of the new option</text:p></table:table-cell><table:table-cell table:style-name="ce11" table:content-validation-name="val1" office:value-type="string" calcext:value-type="string"><text:p>10.</text:p><text:p>Company address line 1</text:p></table:table-cell><table:table-cell table:style-name="ce11" table:content-validation-name="val1" office:value-type="string" calcext:value-type="string"><text:p>11.</text:p><text:p>Company address line 2</text:p></table:table-cell><table:table-cell table:style-name="ce11" table:content-validation-name="val1" office:value-type="string" calcext:value-type="string"><text:p>12.</text:p><text:p>Company address line 3</text:p></table:table-cell><table:table-cell table:style-name="ce11" table:content-validation-name="val1" office:value-type="string" calcext:value-type="string"><text:p>13.</text:p><text:p>Company address line 4</text:p></table:table-cell><table:table-cell table:style-name="ce11" table:content-validation-name="val1" office:value-type="string" calcext:value-type="string"><text:p>14.</text:p><text:p>Country</text:p></table:table-cell><table:table-cell table:style-name="ce11" table:content-validation-name="val1" office:value-type="string" calcext:value-type="string"><text:p>15.</text:p><text:p>Postcode</text:p></table:table-cell><table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string"><text:p>16.</text:p><text:p>Corporation Tax reference</text:p><text:p>(Unique Taxpayer Reference)</text:p></table:table-cell><table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string"><text:p>17.</text:p><text:p>Company Reference Number (CRN)</text:p></table:table-cell><table:table-cell table:number-columns-repeated="1007"/></table:table-row>.toString

    Iterator(sheetName,row1,row2,row3,row4,row5,row6,row7,row8,row9ReplacedHeader,emiReplacedXMLRowMandatoryCells.toString)
  }

  def getIncorrectsheetNameTemplate =
  {
    val sheetName = "EMI40_Adjustment"
    val row1 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce26"><text:p>EMI template - Adjustment of options</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row2 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce27"><text:p>How to complete this schedule:</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row3 = <table:table-row table:style-name="ro2"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce28"><text:p><text:span text:style-name="T1">ONLY complete this sheet if, following a variation in the share capital of the company whose shares are under option, there has been an adjustment of the option price or there has been a change in the description of shares under option.<text:s/></text:span><text:span text:style-name="T1"/></text:p><text:p><text:span text:style-name="T4">Please note</text:span>: Monetary values must be entered to 4 decimal places in pounds sterling.</text:p><text:p>Numbers of shares and securities must be entered to 2 decimal places in pounds sterling.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row4 = <table:table-row table:style-name="ro3"><table:table-cell office:value-type="string" table:number-columns-spanned="6" table:number-rows-spanned="1" table:style-name="ce28"><text:p>Please note: Monetary values must be entered to 4 decimal places in pounds sterling.</text:p><text:p>Numbers of shares and securities must be entered to 2 decimal places.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="5"/><table:table-cell table:number-columns-repeated="8" table:style-name="ce3"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row5 = <table:table-row table:style-name="ro4"><table:table-cell office:value-type="string" table:number-columns-spanned="14" table:number-rows-spanned="1" table:style-name="ce28"><text:p><text:span text:style-name="T2">Important note</text:span><text:span text:style-name="T2"/></text:p><text:p>You<text:s/><text:span text:style-name="T4">must not</text:span><text:s/>alter the structure or formatting of this schedule. If you do your schedule will be rejected.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="13"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row6 = <table:table-row table:style-name="ro2"><table:table-cell office:value-type="string" table:number-columns-spanned="12" table:number-rows-spanned="1" table:style-name="ce28"><text:p>For more information on completing this schedule, follow the link below. You must be connected to the internet to access the guide.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="11"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce4"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row7 = <table:table-row table:style-name="ro1"><table:table-cell office:value-type="string" table:style-name="ce5"><text:p><text:a xlink:href="https://www.gov.uk/government/publications/enterprise-management-incentives-end-of-year-template">EMI guidance</text:a></text:p></table:table-cell><table:table-cell table:style-name="ce6"/><table:table-cell table:number-columns-spanned="3" table:number-rows-spanned="1" table:style-name="ce29"/><table:covered-table-cell table:number-columns-repeated="2"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce7"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:style-name="ce9"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:content-validation-name="val2" table:style-name="ce8"/><table:table-cell table:number-columns-repeated="2" table:style-name="ce4"/><table:table-cell table:number-columns-repeated="16370" table:style-name="ce2"/></table:table-row>.toString
    val row8 = <table:table-row table:style-name="ro1"><table:table-cell table:number-columns-repeated="4" table:style-name="ce10"/><table:table-cell table:number-columns-repeated="16380" table:style-name="ce2"/></table:table-row>.toString
    val row9EMIAdjustmentsHeader = <table:table-row table:style-name="ro5"><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce11"><text:p>1.</text:p><text:p>Has there been any adjustment of options following a variation in the share capital of the company?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce11"><text:p>2.</text:p><text:p>Has there been a change to the description of the shares under option?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce11"><text:p>3.</text:p><text:p>Is the adjustment a disqualifying event?</text:p><text:p>(yes/no). If YES go to question 4. If NO go to question 5.</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce11"><text:p>4.</text:p><text:p>If yes, enter a number from 1 to 8 depending on the nature of the disqualifying event.</text:p><text:p>Follow the link at cell A7 for a list of disqualifying events</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>5.</text:p><text:p>Date option adjusted</text:p><text:p>(yyyy-mm-dd)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>6.</text:p><text:p>Employee first name</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>7.</text:p><text:p>Employee second name</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>8.</text:p><text:p>Employee last name</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>9.</text:p><text:p>National Insurance number</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce3"><text:p>10.</text:p><text:p>PAYE reference of employing company</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>11.</text:p><text:p>Exercise price per share under option before adjustment</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell office:value-type="string" table:style-name="ce13"><text:p>12.</text:p><text:p>Number of shares under the option after adjustment</text:p><text:p>e.g. 100.00</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>13.</text:p><text:p>Exercise price per share under option after the adjustment £</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell office:value-type="string" table:content-validation-name="val1" table:style-name="ce12"><text:p>14.</text:p><text:p>Actual market value of a share at the date of grant</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell table:number-columns-repeated="16370" table:style-name="ce3"/></table:table-row>.toString

    Iterator(sheetName,row1,row2,row3,row4,row5,row6,row7,row8,row9EMIAdjustmentsHeader,emiAdjustmentsXMLRow1.toString)
  }

  def getInvalidCSOPWithoutHeaders: Iterator[String] = {
    val sheetName = "CSOP_OptionsGranted_V3"
    val row1 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce1" office:value-type="date" office:date-value="2015-09-23" calcext:value-type="date"><text:p>2015-09-23</text:p></table:table-cell><table:table-cell office:value-type="float" office:value="250" calcext:value-type="float"><text:p>250</text:p></table:table-cell><table:table-cell table:style-name="ce3" office:value-type="float" office:value="123.12" calcext:value-type="float"><text:p>123.12</text:p></table:table-cell><table:table-cell table:number-columns-repeated="2" table:style-name="ce4" office:value-type="float" office:value="12.1234" calcext:value-type="float"><text:p>12.1234</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>no</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>yes</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>AB12345678</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>no</text:p></table:table-cell><table:table-cell table:number-columns-repeated="1015"/></table:table-row>
    val row2 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce1" office:value-type="date" office:date-value="2015-09-24" calcext:value-type="date"><text:p>2015-09-24</text:p></table:table-cell><table:table-cell office:value-type="float" office:value="251" calcext:value-type="float"><text:p>251</text:p></table:table-cell><table:table-cell table:style-name="ce3" office:value-type="float" office:value="124.12" calcext:value-type="float"><text:p>124.12</text:p></table:table-cell><table:table-cell table:number-columns-repeated="2" table:style-name="ce4" office:value-type="float" office:value="13.1234" calcext:value-type="float"><text:p>13.1234</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>no</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>yes</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>AB12345679</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>no</text:p></table:table-cell><table:table-cell table:number-columns-repeated="1015"/></table:table-row>
    Iterator(sheetName, row1.toString(), row2.toString())
  }

  def getInvalidCSOPWith2Sheets1WithoutHeaders: Iterator[String] = {
    val sheetName1 = "CSOP_OptionsGranted_V3"
    val row1s1 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce1" office:value-type="date" office:date-value="2015-09-23" calcext:value-type="date"><text:p>2015-09-23</text:p></table:table-cell><table:table-cell office:value-type="float" office:value="250" calcext:value-type="float"><text:p>250</text:p></table:table-cell><table:table-cell table:style-name="ce3" office:value-type="float" office:value="123.12" calcext:value-type="float"><text:p>123.12</text:p></table:table-cell><table:table-cell table:number-columns-repeated="2" table:style-name="ce4" office:value-type="float" office:value="12.1234" calcext:value-type="float"><text:p>12.1234</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>no</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>yes</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>AB12345678</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>no</text:p></table:table-cell><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row2s1 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce1" office:value-type="date" office:date-value="2015-09-24" calcext:value-type="date"><text:p>2015-09-24</text:p></table:table-cell><table:table-cell office:value-type="float" office:value="251" calcext:value-type="float"><text:p>251</text:p></table:table-cell><table:table-cell table:style-name="ce3" office:value-type="float" office:value="124.12" calcext:value-type="float"><text:p>124.12</text:p></table:table-cell><table:table-cell table:number-columns-repeated="2" table:style-name="ce4" office:value-type="float" office:value="13.1234" calcext:value-type="float"><text:p>13.1234</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>no</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>yes</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>AB12345679</text:p></table:table-cell><table:table-cell table:style-name="ce5" office:value-type="string" calcext:value-type="string"><text:p>no</text:p></table:table-cell><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val sheetName2 = "CSOP_OptionsRCL_V3"
    val row1s2 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce1" office:value-type="string" calcext:value-type="string"><text:p>CSOP scheme template – Options released (including exchanges) cancelled or lapsed in year</text:p></table:table-cell><table:table-cell table:style-name="ce1" table:number-columns-repeated="8"/><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row2s2 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce2" office:value-type="string" calcext:value-type="string"><text:p>How to complete this schedule:</text:p></table:table-cell><table:table-cell table:style-name="ce2" table:number-columns-repeated="8"/><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row3s2 = <table:table-row table:style-name="ro8"><table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string"><text:p>Enter details of each employee who received money or value on the release, cancellation or lapse of the option.</text:p><text:p><text:span text:style-name="T1">Please note</text:span>: Monetary values must be entered to 4 decimal places in pounds sterling.</text:p><text:p/></table:table-cell><table:table-cell table:style-name="ce3" table:number-columns-repeated="8"/><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row4s2 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce2" office:value-type="string" calcext:value-type="string"><text:p>Important note</text:p></table:table-cell><table:table-cell table:style-name="ce2" table:number-columns-repeated="8"/><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row5s2 = <table:table-row table:style-name="ro9"><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="7" table:number-rows-spanned="1"><text:p>You <text:span text:style-name="T2">must not</text:span> alter the structure or formatting of this schedule. If you do your schedule will be rejected.</text:p><text:p>Please note when completing the template if you leave 10 or more consecutive rows blank with no data populated, It will be assumed that there is no further information contained below these blank rows within this sheet. Therefore it is important you do not leave blank rows between the rows of data you are reporting. Note the system will continue to check for information on subsequent sheets within the same template.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="6"/><table:table-cell table:style-name="ce3" table:number-columns-repeated="2"/><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row6s2 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string"><text:p>For more information on completing this schedule, follow the link below. You must be connected to the internet to access the guide.</text:p></table:table-cell><table:table-cell table:style-name="ce3" table:number-columns-repeated="8"/><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row7s2 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce14" office:value-type="string" calcext:value-type="string"><text:p><text:a xlink:href="https://www.gov.uk/government/publications/company-share-option-plan-end-of-year-return-template" xlink:type="simple">CSOP guidance</text:a></text:p></table:table-cell><table:table-cell table:style-name="ce14" table:number-columns-repeated="8"/><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row8s2 = <table:table-row table:style-name="ro1"><table:table-cell table:number-columns-repeated="1024"/></table:table-row>.toString()
    val row9s2 = <table:table-row table:style-name="ro5"><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>1.</text:p><text:p>Date of event</text:p><text:p>(yyyy-mm-dd)</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>2.</text:p><text:p>Was money or value received by the option holder or anyone else when the option was released, exchanged, cancelled or lapsed?</text:p><text:p>(yes/no)</text:p><text:p>If yes go to question 3, otherwise no further information is needed for this event.</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>3.</text:p><text:p>If yes, amount or value</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>4.</text:p><text:p>Employee first name</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>5.</text:p><text:p>Employee second name</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>6.</text:p><text:p>Employee last name</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>7.</text:p><text:p>National Insurance number</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>8.</text:p><text:p>PAYE reference of employing company</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>9.</text:p><text:p>Was PAYE operated?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row10s2 = <table:table-row table:style-name="ro6"><table:table-cell table:style-name="ce7" office:value-type="date" office:date-value="2015-10-09" calcext:value-type="date"><text:p>2015-10-09</text:p></table:table-cell><table:table-cell office:value-type="string" calcext:value-type="string"><text:p>yes</text:p></table:table-cell><table:table-cell office:value-type="float" office:value="12.1234" calcext:value-type="float"><text:p>12.1234</text:p></table:table-cell><table:table-cell office:value-type="string" calcext:value-type="string"><text:p>Jonathan</text:p></table:table-cell><table:table-cell office:value-type="string" calcext:value-type="string"><text:p>Riley</text:p></table:table-cell><table:table-cell office:value-type="string" calcext:value-type="string"><text:p>Stinston</text:p></table:table-cell><table:table-cell office:value-type="string" calcext:value-type="string"><text:p>AB123456A</text:p></table:table-cell><table:table-cell office:value-type="string" calcext:value-type="string"><text:p>123/CD1234</text:p></table:table-cell><table:table-cell office:value-type="string" calcext:value-type="string"><text:p>yes</text:p></table:table-cell><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString
    Iterator(sheetName1, row1s1, row2s1, sheetName2, row1s2, row2s2, row3s2, row4s2, row5s2, row6s2, row7s2, row8s2, row9s2, row10s2)
  }

  def getCSOPWithoutData: Iterator[String] = {
    val sheetName = "CSOP_OptionsRCL_V3"
    val row1 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce1" office:value-type="string" calcext:value-type="string"><text:p>CSOP scheme template – Options released (including exchanges) cancelled or lapsed in year</text:p></table:table-cell><table:table-cell table:style-name="ce1" table:number-columns-repeated="8"/><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row2 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce2" office:value-type="string" calcext:value-type="string"><text:p>How to complete this schedule:</text:p></table:table-cell><table:table-cell table:style-name="ce2" table:number-columns-repeated="8"/><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row3 = <table:table-row table:style-name="ro8"><table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string"><text:p>Enter details of each employee who received money or value on the release, cancellation or lapse of the option.</text:p><text:p><text:span text:style-name="T1">Please note</text:span>: Monetary values must be entered to 4 decimal places in pounds sterling.</text:p><text:p/></table:table-cell><table:table-cell table:style-name="ce3" table:number-columns-repeated="8"/><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row4 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce2" office:value-type="string" calcext:value-type="string"><text:p>Important note</text:p></table:table-cell><table:table-cell table:style-name="ce2" table:number-columns-repeated="8"/><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row5 = <table:table-row table:style-name="ro9"><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string" table:number-columns-spanned="7" table:number-rows-spanned="1"><text:p>You <text:span text:style-name="T2">must not</text:span> alter the structure or formatting of this schedule. If you do your schedule will be rejected.</text:p><text:p>Please note when completing the template if you leave 10 or more consecutive rows blank with no data populated, It will be assumed that there is no further information contained below these blank rows within this sheet. Therefore it is important you do not leave blank rows between the rows of data you are reporting. Note the system will continue to check for information on subsequent sheets within the same template.</text:p></table:table-cell><table:covered-table-cell table:number-columns-repeated="6"/><table:table-cell table:style-name="ce3" table:number-columns-repeated="2"/><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row6 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce3" office:value-type="string" calcext:value-type="string"><text:p>For more information on completing this schedule, follow the link below. You must be connected to the internet to access the guide.</text:p></table:table-cell><table:table-cell table:style-name="ce3" table:number-columns-repeated="8"/><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row7 = <table:table-row table:style-name="ro1"><table:table-cell table:style-name="ce14" office:value-type="string" calcext:value-type="string"><text:p><text:a xlink:href="https://www.gov.uk/government/publications/company-share-option-plan-end-of-year-return-template" xlink:type="simple">CSOP guidance</text:a></text:p></table:table-cell><table:table-cell table:style-name="ce14" table:number-columns-repeated="8"/><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    val row8 = <table:table-row table:style-name="ro1"><table:table-cell table:number-columns-repeated="1024"/></table:table-row>.toString()
    val row9 = <table:table-row table:style-name="ro5"><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>1.</text:p><text:p>Date of event</text:p><text:p>(yyyy-mm-dd)</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>2.</text:p><text:p>Was money or value received by the option holder or anyone else when the option was released, exchanged, cancelled or lapsed?</text:p><text:p>(yes/no)</text:p><text:p>If yes go to question 3, otherwise no further information is needed for this event.</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>3.</text:p><text:p>If yes, amount or value</text:p><text:p>£</text:p><text:p>e.g. 10.1234</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>4.</text:p><text:p>Employee first name</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>5.</text:p><text:p>Employee second name</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>6.</text:p><text:p>Employee last name</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>7.</text:p><text:p>National Insurance number</text:p><text:p>(if applicable)</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>8.</text:p><text:p>PAYE reference of employing company</text:p></table:table-cell><table:table-cell table:style-name="ce4" office:value-type="string" calcext:value-type="string"><text:p>9.</text:p><text:p>Was PAYE operated?</text:p><text:p>(yes/no)</text:p></table:table-cell><table:table-cell table:number-columns-repeated="1015"/></table:table-row>.toString()
    Iterator(sheetName, row1, row2, row3, row4, row5, row6, row7, row8, row9)
  }

}
